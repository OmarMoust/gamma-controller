<Window x:Class="GammaController.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:GammaController.Converters"
        Title="Gamma Controller"
        Width="320"
        SizeToContent="Height"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        ShowInTaskbar="False"
        Topmost="True"
        ResizeMode="NoResize"
        Deactivated="Window_Deactivated"
        Loaded="Window_Loaded"
        Opacity="0">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Themes/FluentDark.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <!-- Accent color brush (set in code-behind) -->
            <SolidColorBrush x:Key="AccentBrush" Color="#0078D4"/>
            
            <!-- Slide-in animation -->
            <Storyboard x:Key="SlideInAnimation">
                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                 From="0" To="1" Duration="0:0:0.15"/>
                <ThicknessAnimation Storyboard.TargetName="MainBorder"
                                    Storyboard.TargetProperty="Margin"
                                    From="0,20,0,0" To="0,0,0,0" 
                                    Duration="0:0:0.2">
                    <ThicknessAnimation.EasingFunction>
                        <QuadraticEase EasingMode="EaseOut"/>
                    </ThicknessAnimation.EasingFunction>
                </ThicknessAnimation>
            </Storyboard>
            
            <Storyboard x:Key="SlideOutAnimation">
                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                 From="1" To="0" Duration="0:0:0.1"/>
            </Storyboard>
            
            <!-- Monitor button style -->
            <Style x:Key="MonitorButtonStyle" TargetType="RadioButton">
                <Setter Property="Background" Value="#30FFFFFF"/>
                <Setter Property="Foreground" Value="White"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Padding" Value="12,10"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="RadioButton">
                            <Border x:Name="Border"
                                    Background="{TemplateBinding Background}"
                                    CornerRadius="6"
                                    Padding="{TemplateBinding Padding}">
                                <ContentPresenter HorizontalAlignment="Center" 
                                                  VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="#40FFFFFF"/>
                                </Trigger>
                                <Trigger Property="IsChecked" Value="True">
                                    <Setter TargetName="Border" Property="Background" Value="{DynamicResource AccentBrush}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </Window.Resources>

    <!-- Main container - transparent background, blur handled by DWM -->
    <Border x:Name="MainBorder"
            Background="Transparent"
            CornerRadius="8"
            BorderThickness="0"
            Padding="16,32,16,16"
            Margin="0,0,0,0">
        <Border.Effect>
            <DropShadowEffect BlurRadius="24" ShadowDepth="4" Opacity="0.5" Color="Black"/>
        </Border.Effect>
        
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Slider row with sun/moon icons -->
            <Grid Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Low gamma icon (dim) - using Path for white icon -->
                <Path Grid.Column="0"
                      Data="M12,3 C12.5523,3 13,3.44772 13,4 L13,6 C13,6.55228 12.5523,7 12,7 C11.4477,7 11,6.55228 11,6 L11,4 C11,3.44772 11.4477,3 12,3 Z M12,9 C13.6569,9 15,10.3431 15,12 C15,13.6569 13.6569,15 12,15 C10.3431,15 9,13.6569 9,12 C9,10.3431 10.3431,9 12,9 Z"
                      Fill="White"
                      Opacity="0.6"
                      Width="18" Height="18"
                      Stretch="Uniform"
                      VerticalAlignment="Center"
                      Margin="0,0,12,0"/>

                <!-- Gamma slider with Canvas for tooltip positioning -->
                <Grid Grid.Column="1">
                    <Slider x:Name="GammaSlider"
                            Style="{StaticResource FluentSlider}"
                            Minimum="0.5"
                            Maximum="2.0"
                            Value="1.0"
                            TickFrequency="0.01"
                            IsSnapToTickEnabled="False"
                            ValueChanged="GammaSlider_ValueChanged"/>
                    
                    <!-- Tooltip that follows the thumb -->
                    <Canvas x:Name="TooltipCanvas" IsHitTestVisible="False">
                        <Border x:Name="GammaTooltip"
                                Background="#DD000000"
                                CornerRadius="4"
                                Padding="8,4"
                                Visibility="Collapsed"
                                Canvas.Top="-30">
                            <TextBlock x:Name="GammaValueText"
                                       Text="50"
                                       Foreground="White"
                                       FontSize="14"
                                       FontWeight="SemiBold"/>
                        </Border>
                    </Canvas>
                </Grid>

                <!-- High gamma icon (bright) - using Path for white icon -->
                <Path Grid.Column="2"
                      Data="M12,2 C12.5523,2 13,2.44772 13,3 L13,5 C13,5.55228 12.5523,6 12,6 C11.4477,6 11,5.55228 11,5 L11,3 C11,2.44772 11.4477,2 12,2 Z M4.92893,4.92893 C5.31946,4.53841 5.95262,4.53841 6.34315,4.92893 L7.75736,6.34315 C8.14789,6.73367 8.14789,7.36684 7.75736,7.75736 C7.36684,8.14789 6.73367,8.14789 6.34315,7.75736 L4.92893,6.34315 C4.53841,5.95262 4.53841,5.31946 4.92893,4.92893 Z M19.0711,4.92893 C19.4616,5.31946 19.4616,5.95262 19.0711,6.34315 L17.6569,7.75736 C17.2663,8.14789 16.6332,8.14789 16.2426,7.75736 C15.8521,7.36684 15.8521,6.73367 16.2426,6.34315 L17.6569,4.92893 C18.0474,4.53841 18.6805,4.53841 19.0711,4.92893 Z M12,8 C14.2091,8 16,9.79086 16,12 C16,14.2091 14.2091,16 12,16 C9.79086,16 8,14.2091 8,12 C8,9.79086 9.79086,8 12,8 Z M2,12 C2,11.4477 2.44772,11 3,11 L5,11 C5.55228,11 6,11.4477 6,12 C6,12.5523 5.55228,13 5,13 L3,13 C2.44772,13 2,12.5523 2,12 Z M18,12 C18,11.4477 18.4477,11 19,11 L21,11 C21.5523,11 22,11.4477 22,12 C22,12.5523 21.5523,13 21,13 L19,13 C18.4477,13 18,12.5523 18,12 Z M6.34315,16.2426 C6.73367,15.8521 7.36684,15.8521 7.75736,16.2426 C8.14789,16.6332 8.14789,17.2663 7.75736,17.6569 L6.34315,19.0711 C5.95262,19.4616 5.31946,19.4616 4.92893,19.0711 C4.53841,18.6805 4.53841,18.0474 4.92893,17.6569 L6.34315,16.2426 Z M17.6569,16.2426 L19.0711,17.6569 C19.4616,18.0474 19.4616,18.6805 19.0711,19.0711 C18.6805,19.4616 18.0474,19.4616 17.6569,19.0711 L16.2426,17.6569 C15.8521,17.2663 15.8521,16.6332 16.2426,16.2426 C16.6332,15.8521 17.2663,15.8521 17.6569,16.2426 Z M12,18 C12.5523,18 13,18.4477 13,19 L13,21 C13,21.5523 12.5523,22 12,22 C11.4477,22 11,21.5523 11,21 L11,19 C11,18.4477 11.4477,18 12,18 Z"
                      Fill="White"
                      Opacity="0.9"
                      Width="20" Height="20"
                      Stretch="Uniform"
                      VerticalAlignment="Center"
                      Margin="12,0,0,0"/>
            </Grid>

            <!-- Monitor selector - segmented buttons (only shown if multiple monitors) -->
            <UniformGrid x:Name="MonitorButtonsPanel"
                         Grid.Row="2"
                         Rows="1"
                         Margin="0,12,0,0"
                         Visibility="Collapsed">
                <!-- Buttons added dynamically in code-behind -->
            </UniformGrid>
        </Grid>
    </Border>
</Window>
